<!DOCTYPE html>
<!-- saved from url=(0051)https://www.hdh.im/details/5da97eb36623661f183c986e -->
<html ng-app="MyApp" class="ng-scope"><head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="__STATIC__/x_admin/css/xadmin.css">
    <script src="__STATIC__/x_admin/lib/layui/layui.js" charset="utf-8"></script>

	<style type="text/css">
		/* 公共属性 */
		*{margin:0;padding:0;list-style:none;}
		body{background:#fff;font:normal 12px/22px "Microsoft Yahei";}
		img{border:0;}
		a{text-decoration:none;color:#333;}
		a:hover{color:#1974A1;}
		.clearfix:after,.clearfix:before{display:table;line-height:0;content:""}
		.clearfix:after{clear:both}

		/* 主要样式 */
		.container1{width:1180px;margin-right:auto;margin-left:auto;*zoom:1}
		.process{padding:80px 0;text-align:center;}
		.process h3{font-size:30px;line-height:52px;color:#23292E;font-weight:400;}
		.process p{line-height:26px;font-size:14px;color:#999;}
		.process .flowline{margin-top:50px;margin-left:40px;*zoom:1}
		.process .flowline li{float:left;margin-left:110px;text-align:center;list-style:none}
		.process .flowline li .icon-block{position:relative;display:inline-block;width:72px;height:72px;-webkit-border-radius:72px;-moz-border-radius:72px;border-radius:72px;background-color:#181820;line-height:0;margin-top:0}
		.process .flowline li .icon-block img{width:32px;height:32px;background:url(../images/icon.png) 0 0 no-repeat;background-size:192px 64px;margin:20px 20px 0 20px}
		.process .flowline li .icon-block:before{content:''}
		.process .flowline li .icon-block span{margin:0}
		.process .flowline li span{display:inline-block;margin-top:20px;font-size:18px;line-height:36px;color:#333}

		.process .flowline li.process-1{margin-left:28%}
		.process .flowline li.process-3{margin-left:115px}
		.process .flowline li.process-3 .flow-line{display:none}
		.process .flowline .flow-line{position:absolute;top:36px;left:92px;width:77px;border-bottom:1px dotted #979797}.

	</style>
        <title>空港人力-招聘报名系统</title>
        
        
        <!-- 指定以最新的IE版本模式来显示网页 -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- 针对360浏览器的内核调用,强制调用极速模式 -->
        <meta name="renderer" content="webkit">
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        
        <!--Basic Styles-->
        <link href="__STATIC__/demo/bootstrap.min.css" rel="stylesheet">
        <link href="__STATIC__/demo/font-awesome.min.css" rel="stylesheet">
        <link id="beyond-link" href="__STATIC__/demo/beyond.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="__STATIC__/demo/auiicon.css">
        <link rel="stylesheet" href="__STATIC__/demo/base.css">
        <link rel="stylesheet" href="__STATIC__/demo/opensans.css">
        <link href="__STATIC__/demo/darkblue.min.css" rel="stylesheet" type="text/css">
        <link href="__STATIC__/demo/bootstrap-datetimepicker.css" rel="stylesheet" type="text/css">
        <script src="__STATIC__/demo/jquery.min.js"></script>
        <!-- 外部引入的css文件模块 -->
        <!-- 页面头部style样式模块 -->
<body>
	<div class="act-intro-header bg-white" style="display: block;">
        <div style="margin-left: 2%">            
		    <a href="/kgrlenroll/public" class="hd-per-tit pull-left">
		        <img class="pc-logo" src="__STATIC__/demo/indeximg/logo.jpg" width="140" height="44">
		    </a>
		</div>        
	</div>

	<!-- 进度 -->
	<section class="process">
		<div class="container1">
			<h3>上传相关文件</h3>
			<p>仅需3步，即可完成报名</p>
			<ul class="flowline clearfix">
				<li class="process-module process-1">
					<span class="icon-block">
						<img src="__STATIC__/demo/img/msg.png" alt="上传基本信息" style="background-position: -32px 0"> <br /> 
						<span class="flow-line"></span>
					</span>
					<br />
					<span>基本信息</span>
				</li>
				<li class="process-module process-2">
					<span class="icon-block">
						<img src="__STATIC__/demo/img/file.png" alt="上传相关文件" style="background-position: -64px 0"> <br /> 
						<span class="flow-line"></span>
					</span>
					<br /> 
					<span style="font-weight:bold;">相关文件</span> 
				</li>
				<li class="process-module process-3">
					<span class="icon-block">
						<img src="__STATIC__/demo/img/check.png" alt="核对信息,提交审核" style="background-position: -96px 0"> <br /> 
						<span class="flow-line"></span> 
					</span>
					<br />
					<span>核对信息</span> 
				</li>
			</ul> 
		</div>
	</section>
	<!-- 进度 -->




    <div class="hd-entry-wrap con-w  personal">
        <div class=" hd-entry-left">
            <div class="entry-l-brief bg-white padding-20 margin-bottom-20">
                <div class="entry-bri-right pull-left padding-top-10">
                    <a href=""><h3 class="text-ellipsis-2">{$recruit_info.title}</h3></a>
                    <p class=" ">
                        报名时间:<?php echo $plan['start_time']?> ～ <?php echo $plan['end_time']?>	                   
                    </p>
                    <p>
                    	报名单位/岗位: <span style="color: red">{$job_info.company}/{$job_info.name}</span>
                    </p>
                </div>

                <div class="entry-bri-left pull-left">
                <a href="">
                    <img src="#" ></a>
                </div>
                <div class="clearfix"></div>
            </div>

            <!-- 表单开始 -->
            	<fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
				  <legend>上传相关文件</legend>
				</fieldset> 
				 
				<!--上传图片-->

				<div class="layui-upload">
				  <button type="button" class="layui-btn" id="test2">上传身份证（可多选）</button> 
				  <button type="button" class="layui-btn" id="upEducation">上传学历证明(毕业证、学位证等)</button> 
				  <button type="button" class="layui-btn" id="upCunzhao">上传寸照</button> 
				  <button type="button" class="layui-btn" id="upOther">上传其他资料（可多选）</button> 
				 
				  <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;">
				    上传文件列表：
				    <table class="layui-table">
						<colgroup>
						    <col width="150">
						    <col width="200">
						    <col>
						</colgroup>
						<thead>
							<tr>
							  <th>预览</th>
							  <th>类别</th>
							  <th>状态</th>
							  <th>操作</th>
							</tr> 
						</thead>
						<tbody id="demo2">
					    	<!-- <div class="layui-upload-list" id="demo2">
							    
					    	</div> -->
					    	{volist name="file_list" id="vo"}
					    	<tr id="{$vo.file_name_id}tr">

					    		<td>
					    			{switch name="$vo.type" }
									    {case value="pid"}<img src="<?php echo 'http://'.$_SERVER['HTTP_HOST']; ?>{$vo.url}" id="{$vo.file_name_id}" alt="" class="layui-upload-img" >{/case}
									    {case value="education"}{$vo.file_name_id}{/case}
									    {case value="cunzhao"}<img src="<?php echo 'http://'.$_SERVER['HTTP_HOST']; ?>{$vo.url}" id="{$vo.file_name_id}" alt="" class="layui-upload-img" >{/case}
									    {case value="other"}{$vo.file_name_id}{/case}
									    {default /}默认情况
									{/switch}
					    			<!-- <img src="<?php echo 'http://'.$_SERVER['HTTP_HOST']; ?>{$vo.url}" id="{$vo.file_name_id}" alt="" class="layui-upload-img" > -->
					    		</td>
					    		<td>
					    			{switch name="$vo.type" }
									    {case value="pid"}身份证{/case}
									    {case value="education"}学历证明{/case}
									    {case value="cunzhao"}寸照{/case}
									    {case value="other"}其他文件{/case}
									    {default /}默认情况
									{/switch}
								</td>
								<td>上传成功</td>
					    		<td> <button type="button" class="layui-btn" id="{$vo.file_name_id}" onclick='del("{$vo.file_name_id}","{$vo.type}")'>删除重选</button> </td>
					    	</tr>
					    	{/volist}
					    </tbody>
					</table>
				 </blockquote>
				</div>
            <!-- 表单结束 -->
        </div>
        <div class="form-group padding-20 bordered-top-1 bordered-platinum">
            <button class="layui-btn layui-btn-danger" id="baocun_return">上一步</button>
            <button class="btn btn-primary btn-lg" id="baocun2">下一步</button>
        </div>
    </div>

	<div class="footer margin-top-50">
	    <div class="con-w footer-inner  padding-top-30 text-center">
	        <dl>
	            <dt>
	            空港人力-报名系统
	            </dt>
	            <dd>
	            <a href="#" target="_blank">联系方式</a>
	            </dd>
	        </dl>
	        <dl class="">
	            <dt>
	            微信公众号
	            </dt>
	            <dd>
	            <a><img src="__STATIC__/demo/weixin.jpg" width="100"></a>
	            </dd>
	        </dl>
	    </div>
	    <p class=" text-center darkgray padding-top-10">© 2020 空港人力 | 渝ICP备xxxxxx号 | 通讯地址：重庆市渝北区春华大道99号<br>招聘报名系统　版权所有</p>
	</div>

</body>
</html>
<script src="__STATIC__/layer/2.4/layer.js" charset="utf-8"></script>

<script>
$("#baocun_return").click(function () {
	layer.confirm('确认返回吗？', {
	  btn: ['确认','取消'] //按钮
	}, function(){
		$(location).attr('href', '/kgrlenroll/public/index.php/index/index/enroll?job_id={$job_info.id}');
	}, function(){
	});
})
layui.use('upload', function (){
  var upload = layui.upload,
    $ = layui.jquery;
	//上传身份证
	var uploadInst = upload.render({
	  elem : '#test2',
	  accept : 'images',//指定允许上传时校验的文件类型，可选值有：images（图片）、file（所有文件）、video（视频）、audio（音频）
	  multiple : 'true',
	  url : "{:url('Index/index/uploadFilePid')}",
	  data: {user_id:{$user_id},job_id:{$job_info.id}},
	  before: function(obj){
	      //预读本地文件示例，不支持ie8
	      obj.preview(function(index, file, result){
	        if((file.type).indexOf("image") >= 0 ){
	        	var file_name_id = file.name.split(".")[0];
	        	var file_name_id = file_name_id.replace("//s/g", "");
	        	if($("#"+file_name_id).length>0){
					layer.msg('相同文件请勿重复上传',{time:'5000',tipsMore: true,zIndex:'2'});
					window.location.reload();return false;
				}else{
					$('#demo2').append('<tr id="'+file_name_id+'tr"><td><img src="'+ result +'" id="'+file_name_id+'" alt="'+ file.name +'" class="layui-upload-img" ></td><td>身份证</td><td>上传成功</td><td> <button type="button" class="layui-btn" onclick="del('+"'"+file_name_id+"'"+','+"'"+'pid'+"'"+')">删除重选</button> </td></tr>')
				}
			}else{
				$('#demo2').append(file.name)
			}
	        console.log(file);
	      });
	    },
	  done : function(res){
	 
	     layer.msg(res.msg,{time:'5000',tipsMore: true,zIndex:'2'}); 
	    
	  },
	  allDone: function(obj){ //当文件全部被提交后，才触发
	   $('.layui-word-aux').append("执行完毕，文件总数："+obj.total+"成功："+obj.successful+"个，失败："+obj.aborted+"个");
	    console.log(obj.total); //得到总文件数
	    console.log(obj.successful); //请求成功的文件数
	    console.log(obj.aborted); //请求失败的文件数
	  },
	  error : function(){
	    
	    //请求异常
	  }
	 
	});

	//上传学历证明
	var uploadInst = upload.render({
	  elem : '#upEducation',
	  accept : 'file',//指定允许上传时校验的文件类型，可选值有：images（图片）、file（所有文件）、video（视频）、audio（音频）
	  multiple : 'true',
	  url : "{:url('Index/index/uploadFileEducation')}",
	  data: {user_id:{$user_id},job_id:{$job_info.id}},
	  before: function(obj){
	      //预读本地文件示例，不支持ie8
	      obj.preview(function(index, file, result){
	        if((file.type).indexOf("image") >= 0 ){
	        	var file_name_id = file.name.split(".")[0];
	        	var file_name_id = file_name_id.replace("//s/g", "");
	        	if($("#"+file_name_id).length>0){
					layer.msg('相同文件请勿重复上传',{time:'5000',tipsMore: true,zIndex:'2'});
					window.location.reload();return false;
				}else{
					$('#demo2').append('<tr id="'+file_name_id+'tr"><td id="'+file_name_id+'">'+file.name+'</td><td>学历证明</td><td>上传成功</td><td> <button type="button" class="layui-btn" onclick="del('+"'"+file_name_id+"'"+','+"'"+'education'+"'"+')" >删除重选</button> </td></tr>')
				}
	        	// var file_name = $("#"+file.name).val();
				// $('#demo2').append('<tr><td><img id="'+file.name+'" src="'+ result +'" alt="'+ file.name +'" class="layui-upload-img" ></td><td>学历证明</td><td> <button type="button" class="layui-btn">删除重选</button> </td></tr>')
			}else{
				var file_name_id = file.name.split(".")[0];
				var file_name_id = file_name_id.replace(/\s/g, "");
	        	if($("#"+file_name_id).length>0){
					layer.msg('相同文件请勿重复上传',{time:'5000',tipsMore: true,zIndex:'2'});
					window.location.reload();return false;
				}else{
					$('#demo2').append('<tr id="'+file_name_id+'tr"><td id="'+file_name_id+'">'+file.name+'</td><td>学历证明</td><td>上传成功</td><td> <button type="button" class="layui-btn" onclick="del('+"'"+file_name_id+"'"+','+"'"+'education'+"'"+')">删除重选</button> </td></tr>')
				}
				// $('#demo2').append('<tr><td>'+file.name+'</td><td>学历证明</td><td> <button type="button" class="layui-btn">删除重选</button> </td></tr>')
				
			}
	        console.log(file);
	      });
	    },
	  done : function(res){
	 
	     layer.msg(res.msg,{time:'5000',tipsMore: true,zIndex:'2'}); 
	    
	  },
	  allDone: function(obj){ //当文件全部被提交后，才触发
	   $('.layui-word-aux').append("执行完毕，文件总数："+obj.total+"成功："+obj.successful+"个，失败："+obj.aborted+"个");
	    console.log(obj.total); //得到总文件数
	    console.log(obj.successful); //请求成功的文件数
	    console.log(obj.aborted); //请求失败的文件数
	  },
	  error : function(){
	    
	    //请求异常
	  }
	 
	});


	//上传寸照
	var uploadInst = upload.render({
	  elem : '#upCunzhao',
	  accept : 'images',//指定允许上传时校验的文件类型，可选值有：images（图片）、file（所有文件）、video（视频）、audio（音频）
	  multiple : 'true',
	  url : "{:url('Index/index/uploadFileCunzhao')}",
	  data: {user_id:{$user_id},job_id:{$job_info.id}},
	  before: function(obj){
	      //预读本地文件示例，不支持ie8
	      obj.preview(function(index, file, result){
	        if((file.type).indexOf("image") >= 0 ){
	        	var file_name_id = file.name.split(".")[0];
	        	var file_name_id = file_name_id.replace("//s/g", "");
	        	if($("#"+file_name_id).length>0){
					layer.msg('相同文件请勿重复上传',{time:'5000',tipsMore: true,zIndex:'2'});
					window.location.reload();
					return false;
				}else{
					$('#demo2').append('<tr id="'+file_name_id+'tr"><td id="'+file_name_id+'">'+file.name+'</td><td>学历证明</td><td>上传成功</td><td> <button type="button" class="layui-btn" onclick="del('+"'"+file_name_id+"'"+','+"'"+'education'+"'"+')" >删除重选</button> </td></tr>')
				}
	        	// var file_name = $("#"+file.name).val();
				// $('#demo2').append('<tr><td><img id="'+file.name+'" src="'+ result +'" alt="'+ file.name +'" class="layui-upload-img" ></td><td>学历证明</td><td> <button type="button" class="layui-btn">删除重选</button> </td></tr>')
			}else{
				
				
			}
	        console.log(file);
	      });
	    },
	  done : function(res){
	 
	     layer.msg(res.msg,{time:'5000',tipsMore: true,zIndex:'2'}); 
	    
	  },
	  allDone: function(obj){ //当文件全部被提交后，才触发
	   $('.layui-word-aux').append("执行完毕，文件总数："+obj.total+"成功："+obj.successful+"个，失败："+obj.aborted+"个");
	    console.log(obj.total); //得到总文件数
	    console.log(obj.successful); //请求成功的文件数
	    console.log(obj.aborted); //请求失败的文件数
	  },
	  error : function(){
	    
	    //请求异常
	  }
	 
	});

	//上传其他
	var uploadInst = upload.render({
	  elem : '#upOther',
	  accept : 'file',//指定允许上传时校验的文件类型，可选值有：images（图片）、file（所有文件）、video（视频）、audio（音频）
	  multiple : 'true',
	  url : "{:url('Index/index/uploadFileOther')}",
	  data: {user_id:{$user_id},job_id:{$job_info.id}},
	  before: function(obj){
	      //预读本地文件示例，不支持ie8
	      obj.preview(function(index, file, result){
	        if((file.type).indexOf("image") >= 0 ){
	        	var file_name_id = file.name.split(".")[0];
	        	var file_name_id = file_name_id.replace("//s/g", "");
	        	if($("#"+file_name_id).length>0){
					layer.msg('相同文件请勿重复上传',{time:'5000',tipsMore: true,zIndex:'2'});
					window.location.reload();return false;
				}else{
					$('#demo2').append('<tr id="'+file_name_id+'tr"><td id="'+file_name_id+'">'+file.name+'</td><td>学历证明</td><td>上传成功</td><td> <button type="button" class="layui-btn" onclick="del('+"'"+file_name_id+"'"+','+"'"+'education'+"'"+')" >删除重选</button> </td></tr>')
				}
	        	// var file_name = $("#"+file.name).val();
				// $('#demo2').append('<tr><td><img id="'+file.name+'" src="'+ result +'" alt="'+ file.name +'" class="layui-upload-img" ></td><td>学历证明</td><td> <button type="button" class="layui-btn">删除重选</button> </td></tr>')
			}else{
				var file_name_id = file.name.split(".")[0];
				var file_name_id = file_name_id.replace(/\s/g, "");
	        	if($("#"+file_name_id).length>0){
					layer.msg('相同文件请勿重复上传',{time:'5000',tipsMore: true,zIndex:'2'});
					window.location.reload();return false;
				}else{
					$('#demo2').append('<tr id="'+file_name_id+'tr"><td id="'+file_name_id+'">'+file.name+'</td><td>学历证明</td><td>上传成功</td><td> <button type="button" class="layui-btn" onclick="del('+"'"+file_name_id+"'"+','+"'"+'education'+"'"+')">删除重选</button> </td></tr>')
				}
				// $('#demo2').append('<tr><td>'+file.name+'</td><td>学历证明</td><td> <button type="button" class="layui-btn">删除重选</button> </td></tr>')
				
			}
	        console.log(file);
	      });
	    },
	  done : function(res){
	 
	     layer.msg(res.msg,{time:'5000',tipsMore: true,zIndex:'2'}); 
	    
	  },
	  allDone: function(obj){ //当文件全部被提交后，才触发
	   $('.layui-word-aux').append("执行完毕，文件总数："+obj.total+"成功："+obj.successful+"个，失败："+obj.aborted+"个");
	    console.log(obj.total); //得到总文件数
	    console.log(obj.successful); //请求成功的文件数
	    console.log(obj.aborted); //请求失败的文件数
	  },
	  error : function(){
	    
	    //请求异常
	  }
	 
	});

	
});

function del(file_name_id,type) {
	//询问框

	layer.confirm('确认删除吗？', {
	  btn: ['确认','取消'] //按钮
	}, function(){
		$.ajax({
	        type:"POST",
	        dataType:"json",
	        url:"{:url('Index/index/enroll_del')}",
	        data:{file_name_id:file_name_id,type:type,job_id:{$job_info.id},user_id:{$user_id}},
	        success:function(data){
	          if (data.code == 1) {
	          	$("#"+file_name_id+"tr").remove();
	            layer.msg('删除成功', {time: 2000, icon:6});
	            // window.location.reload();
	          }else{
	            layer.msg(data.msg, {time: 2000, icon:5});
	            layer.close(index);
	            return false;
	          }
	        }
	    });
	}, function(){
	});
}


// 下一步
$("#baocun2").click(function () {
	layer.confirm('确认提交信息吗？', {
	  btn: ['确认','取消'] //按钮
	}, function(){
		$(location).attr('href', '/kgrlenroll/public/index.php/index/index/enroll_check?job_id={$job_info.id}&user_id={$user_id}');
	}, function(){
	});
});
</script>